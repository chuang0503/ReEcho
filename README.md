please refer to AAAI code
